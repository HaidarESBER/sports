---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified: [prisma/schema.prisma, src/lib/db.ts, .env, .env.example, .gitignore]
autonomous: true
---

<objective>
Set up Prisma ORM with SQLite for development and configure environment variables.

Purpose: Establish database layer that Phase 2 will use to define data models.
Output: Working Prisma setup with db client, environment configuration, and proper git ignores.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install and initialize Prisma with SQLite</name>
  <files>prisma/schema.prisma, package.json</files>
  <action>
    Install Prisma and initialize with SQLite:

    ```bash
    npm install prisma @prisma/client
    npx prisma init --datasource-provider sqlite
    ```

    This creates:
    - prisma/schema.prisma with SQLite datasource
    - .env file with DATABASE_URL

    SQLite for development because:
    - Zero setup required
    - Fast iteration
    - Easy to switch to PostgreSQL for production later

    The schema.prisma will have empty models - Phase 2 will add User, Session, Program, etc.
  </action>
  <verify>prisma/schema.prisma exists with SQLite datasource configured</verify>
  <done>Prisma initialized with SQLite, schema.prisma ready for models</done>
</task>

<task type="auto">
  <name>Task 2: Create Prisma client singleton</name>
  <files>src/lib/db.ts</files>
  <action>
    Create Prisma client singleton for Next.js:

    ```typescript
    import { PrismaClient } from '@prisma/client'

    const globalForPrisma = globalThis as unknown as {
      prisma: PrismaClient | undefined
    }

    export const prisma = globalForPrisma.prisma ?? new PrismaClient()

    if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma
    ```

    Why singleton: Next.js dev server hot-reloads, creating multiple Prisma clients without this pattern. The singleton reuses the existing client.

    Export as `prisma` for consistent imports across the codebase.
  </action>
  <verify>TypeScript compiles src/lib/db.ts without errors</verify>
  <done>Prisma client singleton created and exportable</done>
</task>

<task type="auto">
  <name>Task 3: Configure environment and git ignores</name>
  <files>.env.example, .gitignore</files>
  <action>
    Create .env.example with placeholder values:

    ```
    # Database
    DATABASE_URL="file:./dev.db"

    # Auth (Phase 3)
    # NEXTAUTH_SECRET=
    # NEXTAUTH_URL=http://localhost:3000
    ```

    Update .gitignore to include:

    ```
    # Environment
    .env
    .env.local
    .env*.local

    # Database
    prisma/dev.db
    prisma/dev.db-journal

    # Dependencies
    node_modules/

    # Build
    .next/
    out/

    # IDE
    .idea/
    .vscode/
    *.swp
    ```

    IMPORTANT: Ensure .env is ignored (contains secrets). Only .env.example is tracked.
  </action>
  <verify>.env.example exists, .gitignore contains .env and prisma/dev.db entries</verify>
  <done>Environment template created, secrets properly ignored</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx prisma generate` succeeds
- [ ] `npm run build` still succeeds after Prisma added
- [ ] .env is in .gitignore
- [ ] prisma/dev.db is in .gitignore
- [ ] src/lib/db.ts exports prisma client
</verification>

<success_criteria>

- All tasks completed
- Prisma installed and configured for SQLite
- Prisma client singleton ready for use
- Environment properly configured with .env.example template
- Sensitive files excluded from git
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
