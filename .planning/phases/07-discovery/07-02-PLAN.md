---
phase: 07-discovery
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [src/app/discover/page.tsx, src/app/discover/DiscoverTabs.tsx, src/components/SearchFilters.tsx]
autonomous: false
---

<objective>
Create discovery UI page with search, filters, and tabbed navigation for exploring programs, sessions, and users.

Purpose: Enable users to discover public content through an intuitive search and filter interface.
Output: /discover page with tabs, search bar, filters, and paginated results
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/app/programs/page.tsx
@src/components/ProgramCard.tsx
@src/components/SessionCard.tsx
@src/components/UserCard.tsx
@src/app/users/[id]/PublicProfileTabs.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SearchFilters component</name>
  <files>src/components/SearchFilters.tsx</files>
  <action>
Create a reusable client component for search and filters.

Props:
- onSearch: (query: string) => void
- onFilterChange: (filters: FilterState) => void
- showSportFilter?: boolean (default true)
- showDifficultyFilter?: boolean (default false)
- showDurationFilter?: boolean (default false)

Features:
- Search input with 300ms debounce (reuse pattern from ExerciseSelector)
- Sport filter dropdown (running, swimming, cycling, strength, other)
- Difficulty filter dropdown (debutant, intermediaire, avance) - conditional
- Duration range inputs (min/max weeks or minutes) - conditional
- Clear filters button
- Tailwind styling matching existing components

Use useState for local filter state, call callbacks on change.
  </action>
  <verify>Component exports correctly, TypeScript compiles</verify>
  <done>SearchFilters component handles search with debounce and filter changes</done>
</task>

<task type="auto">
  <name>Task 2: Create DiscoverTabs client component</name>
  <files>src/app/discover/DiscoverTabs.tsx</files>
  <action>
Create client component for tab navigation and content display.

Features:
- Three tabs: Programmes, Seances, Utilisateurs
- URL sync via searchParams (?tab=programs|sessions|users)
- Each tab fetches from discovery API on mount and filter change
- Loading states while fetching
- Empty states when no results
- Pagination controls (Previous/Next) at bottom
- Reuse ProgramCard, SessionCard, UserCard for display

State:
- activeTab (from URL or default 'programs')
- results array
- loading boolean
- pagination (page, totalPages, total)
- filters (search, sport, difficulty, duration)

On tab change or filter change, reset to page 1 and fetch.
API calls: /api/discover/{programs|sessions|users}?search=...&sport=...&page=...
  </action>
  <verify>Component renders tabs and fetches data on tab/filter change</verify>
  <done>DiscoverTabs displays tabbed content with API integration and pagination</done>
</task>

<task type="auto">
  <name>Task 3: Create discover page</name>
  <files>src/app/discover/page.tsx</files>
  <action>
Create the main /discover page as a server component shell.

Structure:
- Header with title "Decouvrir" and subtitle
- SearchFilters component (client) for search and filters
- DiscoverTabs component (client) for tabbed results

Layout:
- max-w-7xl container like other pages
- Consistent padding and spacing
- No auth required (public page, but auth state passed to DiscoverTabs for follow button)

Pass initial searchParams to DiscoverTabs for URL-based tab selection.
  </action>
  <verify>npm run build succeeds, page renders at /discover</verify>
  <done>Discover page displays with search, filters, and tabbed results</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete discovery page with search, filters, and tabbed navigation</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/discover
    3. Verify tabs work: click Programmes, Seances, Utilisateurs
    4. Test search: type in search box, verify results update after typing stops
    5. Test filters: select a sport, verify results filter
    6. Test pagination: if many results, click Next/Previous
    7. Test empty state: search for something that doesn't exist
    8. Test responsive: resize browser, verify mobile layout
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds
- [ ] /discover page loads without errors
- [ ] All three tabs display correct content
- [ ] Search filters results in real-time (debounced)
- [ ] Sport filter works across all tabs
- [ ] Pagination controls work
- [ ] Cards link to correct detail pages
- [ ] User approved visual verification
</verification>

<success_criteria>
- All tasks completed
- Discovery UI fully functional
- Search and filters work correctly
- User approved the implementation
</success_criteria>

<output>
After completion, create `.planning/phases/07-discovery/07-02-SUMMARY.md`
</output>
